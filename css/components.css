/* ================================================================
   COMPONENTS — Cartes, badges, boutons, action log, statut,
                dossier progress, notes, quick-notes, quick actions
================================================================ */

/* CARD GRID */
#card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 14px; }
.derog-card { background: var(--bg-surface); border: 1px solid var(--border); border-radius: var(--radius-lg); border-left: 3px solid var(--status-new-text); padding: 14px 16px; cursor: pointer; transition: all var(--transition); box-shadow: var(--shadow-card); display: flex; flex-direction: column; gap: 10px; }
.derog-card:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(0,0,0,0.4); border-color: var(--accent); }
.derog-card.selected { border-color: var(--accent); background: var(--bg-hover); }
.derog-card[data-status="new"]       { border-left-color: var(--status-new-text); }
.derog-card[data-status="en_revue"]  { border-left-color: var(--status-review-text); }
.derog-card[data-status="validated"] { border-left-color: var(--status-validated-text); }
.derog-card[data-status="expired"]  { border-left-color: var(--status-expired-text); opacity: 0.75; }
.card-top { display: flex; align-items: center; gap: 6px; }
.card-ticket { font-family: var(--font-mono); font-size: 11px; color: var(--text-muted); flex: 1; }
.card-title { font-size: 14px; font-weight: 600; color: var(--text-primary); line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.card-meta { font-size: 12px; color: var(--text-secondary); display: flex; align-items: center; gap: 6px; }
.card-bottom { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
.card-action-status { display: flex; align-items: center; gap: 5px; font-size: 12px; font-weight: 500; }
.card-expiry { font-size: 12px; font-weight: 500; }

/* BADGES */
.badge { display: inline-flex; align-items: center; gap: 5px; padding: 2px 10px; border-radius: var(--radius-full); font-size: 11px; font-weight: 600; white-space: nowrap; border: 1px solid transparent; }
.badge-new { background: var(--status-new-bg); color: var(--status-new-text); border-color: var(--status-new-border); }
.badge-en_revue  { background: var(--status-review-bg);    color: var(--status-review-text);    border-color: var(--status-review-border); }
.badge-validated { background: var(--status-validated-bg); color: var(--status-validated-text); border-color: var(--status-validated-border); }
.badge-expired  { background: var(--status-expired-bg);   color: var(--status-expired-text);   border-color: var(--status-expired-border); }
.badge-dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; flex-shrink: 0; }
.badge-motif { display: inline-flex; align-items: center; gap: 4px; padding: 2px 9px; border-radius: var(--radius-full); font-size: 11px; font-weight: 600; white-space: nowrap; background: rgba(240,136,62,0.13); color: var(--action-attente-demandeur); border: 1px solid rgba(240,136,62,0.35); }
.chip { display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600; }
.chip-danger { background: rgba(248,81,73,0.15); color: var(--status-rejected-text); }
.chip-warn { background: rgba(240,136,62,0.15); color: var(--urgency-p1); }
.chip-muted { background: var(--bg-elevated); color: var(--text-muted); }
.urgency-badge { font-size: 10px; font-weight: 800; padding: 1px 6px; border-radius: var(--radius-sm); letter-spacing: 0.03em; }
.urgency-p0 { background: rgba(255,123,114,0.2); color: var(--urgency-p0); border: 1px solid rgba(255,123,114,0.4); }
.urgency-p1 { background: rgba(240,136,62,0.2); color: var(--urgency-p1); border: 1px solid rgba(240,136,62,0.4); }
.dic-row { display: inline-flex; gap: 4px; align-items: center; }
.dic-val { font-size: 11px; font-weight: 700; width: 22px; height: 20px; border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; font-family: var(--font-mono); }
.dic-1 { background: rgba(63,185,80,0.15); color: var(--risk-1); }
.dic-2 { background: rgba(227,179,65,0.15); color: var(--risk-2); }
.dic-3 { background: rgba(240,136,62,0.15); color: var(--risk-3); }
.dic-4 { background: rgba(248,81,73,0.15); color: var(--risk-4); }
.dic-unknown { background: var(--bg-elevated); color: var(--text-muted); font-style: italic; }

/* ACTION COLORS */
.action-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.action-a_faire            { color: var(--action-a-faire); }
.action-a_faire            .action-dot { background: var(--action-a-faire); }
.action-attente_demandeur  { color: var(--action-attente-demandeur); }
.action-attente_demandeur  .action-dot { background: var(--action-attente-demandeur); }
.action-reunion_prevue     { color: var(--action-reunion-prevue); }
.action-reunion_prevue     .action-dot { background: var(--action-reunion-prevue); }
.action-suivi_date         { color: var(--action-suivi-date); }
.action-suivi_date         .action-dot { background: var(--action-suivi-date); }
.action-attente_validation { color: var(--action-attente-validation); }
.action-attente_validation .action-dot { background: var(--action-attente-validation); }
.action-termine            { color: var(--action-termine); }
.action-termine            .action-dot { background: var(--action-termine); }
.expiry-ok { color: var(--text-secondary); }
.expiry-warn { color: var(--urgency-p1); font-weight: 600; }
.expiry-danger { color: var(--urgency-p0); font-weight: 700; }
.expiry-past { color: var(--status-expired-text); }

/* EMPTY STATE */
.empty-state { text-align: center; padding: 64px 24px; color: var(--text-muted); }
.empty-state svg { margin-bottom: 16px; opacity: 0.4; }
.empty-state h3 { font-size: 16px; color: var(--text-secondary); margin-bottom: 8px; }
.empty-state p { font-size: 13px; }

/* STATUT SN — badge-select interactif (hero-top) */
.status-badge-select { width: auto; flex: 0 0 auto; appearance: none; -webkit-appearance: none; padding: 2px 10px; border-radius: var(--radius-full); font-size: 11px; font-weight: 600; border: 1px solid; cursor: pointer; line-height: 1.6; }
.status-badge-select:hover { filter: brightness(1.1); }
.status-badge-select-new       { background: var(--status-new-bg);       color: var(--status-new-text);       border-color: var(--status-new-border); }
.status-badge-select-en_revue  { background: var(--status-review-bg);    color: var(--status-review-text);    border-color: var(--status-review-border); }
.status-badge-select-validated { background: var(--status-validated-bg); color: var(--status-validated-text); border-color: var(--status-validated-border); }
.status-badge-select-expired   { background: var(--status-expired-bg);   color: var(--status-expired-text);   border-color: var(--status-expired-border); }

/* BOUTON VÉRIF SERVICENOW (hero-top, poussé à droite) */
.lc-verify-btn { margin-left: auto; flex: 0 0 auto; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: var(--radius-full); border: 1px solid var(--border); background: none; cursor: pointer; white-space: nowrap; transition: all var(--transition); color: var(--text-muted); }
.lc-verify-btn:hover { background: var(--bg-elevated); }
.lc-verify-btn.last-check-ok   { color: #3fb950; border-color: rgba(63,185,80,0.45); }
.lc-verify-btn.last-check-warn { color: #f59e42; border-color: rgba(245,158,66,0.45); }
.lc-verify-btn.last-check-late { color: #f85149; border-color: rgba(248,81,73,0.45); }
.lc-verify-btn.last-check-none { color: #f85149; border-color: rgba(248,81,73,0.45); }

/* HERO — porteur inline (sous ticket ID) */
.sidebar-hero-porteur { display: flex; align-items: center; gap: 5px; margin-top: 6px; font-size: 11px; min-width: 0; }
.sidebar-hero-avatar-sm { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 50%; background: var(--accent); color: #fff; font-size: 9px; font-weight: 700; flex-shrink: 0; }
.sidebar-hero-name { color: var(--text-secondary); font-weight: 500; white-space: nowrap; }
.sidebar-hero-asset { color: var(--text-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0; }

/* BOUTON RÉUNION (hero sidebar) */
.sidebar-ticket-row { display: flex; align-items: center; justify-content: space-between; gap: 8px; margin-top: 2px; }
.btn-meeting { font-size: 11px; font-weight: 600; padding: 3px 10px; border-radius: var(--radius-full); border: 1px solid var(--border); color: var(--text-muted); background: none; display: inline-flex; align-items: center; gap: 5px; cursor: pointer; transition: all var(--transition); white-space: nowrap; }
.btn-meeting:hover { border-color: #f97316; color: #f97316; }
.btn-meeting.has-content { border-color: #f97316; color: #f97316; background: rgba(249,115,22,0.12); }
.meeting-dot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: #f97316; flex-shrink: 0; }

/* MEETING NOTES — préparation réunion */
.meeting-notes-wrap { border-radius: var(--radius-md); overflow: hidden; border: 1px solid #c05a00; }
.meeting-notes-header { display: flex; align-items: center; gap: 6px; padding: 6px 10px; background: #f97316; color: #fff; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .06em; }
[data-theme="dark"] .meeting-notes-header { background: #7c2d00; color: #fdba74; border-bottom: 1px solid #c05a00; }
.meeting-notes-clear { margin-left: auto; font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: var(--radius-full); border: 1px solid rgba(255,255,255,0.5); color: #fff; background: rgba(255,255,255,0.15); cursor: pointer; transition: all var(--transition); }
.meeting-notes-clear:hover { background: rgba(255,255,255,0.3); }
[data-theme="dark"] .meeting-notes-clear { border-color: rgba(253,186,116,0.4); color: #fdba74; background: rgba(253,186,116,0.1); }
[data-theme="dark"] .meeting-notes-clear:hover { background: rgba(253,186,116,0.2); }
.meeting-notes-textarea { width: 100%; min-height: 80px; resize: none; overflow-y: hidden; background: #fff7ed; border: none; padding: 10px 12px; color: #431407; font-family: var(--font); font-size: 13px; line-height: 1.6; display: block; }
[data-theme="dark"] .meeting-notes-textarea { background: #2c1500; color: #fed7aa; }
.meeting-notes-textarea::placeholder { color: #c2a080; }
[data-theme="dark"] .meeting-notes-textarea::placeholder { color: #7c5030; }
.meeting-notes-textarea:focus { outline: none; box-shadow: inset 0 0 0 2px rgba(249,115,22,0.5); }
.meeting-notes-hint { font-size: 11px; color: var(--text-muted); text-align: right; margin-top: 3px; transition: color 0.3s; }
.meeting-notes-hint.saved { color: var(--status-validated-text); }

/* QUICK NOTES — post-it */
.quick-notes-wrap { border-radius: var(--radius-md); overflow: hidden; border: 1px solid #d4b800; }
.quick-notes-header { display: flex; align-items: center; gap: 6px; padding: 6px 10px; background: #f5e000; color: #3a2e00; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .06em; }
[data-theme="dark"] .quick-notes-header { background: #3d3000; color: #f0d060; border-bottom: 1px solid #5a4800; }
.quick-notes-textarea { width: 100%; min-height: 80px; resize: none; overflow-y: hidden; background: #fef9c3; border: none; padding: 10px 12px; color: #2d2400; font-family: var(--font); font-size: 13px; line-height: 1.6; display: block; }
[data-theme="dark"] .quick-notes-textarea { background: #221e00; color: #f0e090; }
.quick-notes-textarea::placeholder { color: #a09050; }
[data-theme="dark"] .quick-notes-textarea::placeholder { color: #6a5c20; }
.quick-notes-textarea:focus { outline: none; box-shadow: inset 0 0 0 2px rgba(212,184,0,0.5); }
.quick-notes-hint { font-size: 11px; color: var(--text-muted); text-align: right; margin-top: 3px; transition: color 0.3s; }
.quick-notes-hint.saved { color: var(--status-validated-text); }

/* ACTION LOG — journal des actions (fond gris) */
.action-log-wrap { border-radius: var(--radius-md); overflow: hidden; border: 1px solid var(--border); }
.action-log-header { display: flex; align-items: center; gap: 6px; padding: 6px 10px; background: var(--bg-elevated); color: var(--text-secondary); font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .06em; border-bottom: 1px solid var(--border); justify-content: flex-start; }
.action-log-body { background: var(--bg-surface); display: flex; flex-direction: column; }
.action-log-row { display: flex; align-items: center; gap: 6px; padding: 5px 8px; border-bottom: 1px solid var(--border-muted); }
.action-log-row:last-child { border-bottom: none; }
.action-log-date { flex: 0 0 auto; width: 96px; font-size: 12px; padding: 3px 6px; background: var(--bg-elevated); border: 1px solid var(--border-muted); border-radius: var(--radius-sm); color: var(--text-secondary); }
.action-log-date:focus { border-color: var(--accent); background: var(--bg-input); outline: none; }
.action-log-actor { font-size: 14px; flex-shrink: 0; cursor: default; }
.action-log-etype { font-size: 14px; flex-shrink: 0; cursor: default; }
.action-log-text { flex: 1; font-size: 12px; padding: 3px 6px; background: transparent; border: 1px solid transparent; border-radius: var(--radius-sm); color: var(--text-primary); }
.action-log-text:focus { background: var(--bg-input); border-color: var(--accent); outline: none; }
.action-log-text::placeholder { color: var(--text-muted); }
.action-log-btn-add-header { margin-left: auto; flex-shrink: 0; width: 20px; height: 20px; border-radius: var(--radius-sm); border: 1px solid var(--border); color: var(--text-muted); font-size: 15px; font-weight: 700; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all var(--transition); line-height: 1; padding: 0; background: none; }
.action-log-btn-add-header:hover { border-color: var(--accent); color: var(--accent); background: rgba(88,166,255,0.08); }
.action-log-btn-remove { flex-shrink: 0; width: 22px; height: 22px; border-radius: var(--radius-sm); border: 1px solid var(--border); color: var(--text-muted); font-size: 15px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all var(--transition); line-height: 1; padding: 0; }
.action-log-btn-remove:hover { border-color: var(--status-rejected-text); color: var(--status-rejected-text); background: rgba(248,81,73,0.08); }
.action-log-empty { padding: 10px 12px; display: flex; justify-content: center; }
.action-log-btn-new { font-size: 12px; color: var(--text-muted); border: 1px dashed var(--border); border-radius: var(--radius-sm); padding: 5px 14px; cursor: pointer; transition: all var(--transition); background: none; }
.action-log-btn-new:hover { border-color: var(--accent); color: var(--accent); }
.action-log-more { width: 100%; text-align: center; font-size: 11px; color: var(--text-muted); padding: 5px; cursor: pointer; background: var(--bg-elevated); border: none; border-top: 1px solid var(--border-muted); transition: color var(--transition); }
.action-log-more:hover { color: var(--text-primary); }
.action-log-hint { font-size: 11px; color: var(--text-muted); text-align: right; margin-top: 3px; transition: color 0.3s; }
.action-log-hint.saved { color: var(--status-validated-text); }

/* DOSSIER PROGRESS */
.dossier-progress { display: flex; align-items: center; gap: 8px; }
.dossier-progress-bar-wrap { flex: 1; height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; }
.dossier-progress-bar { height: 100%; border-radius: 2px; background: var(--accent); transition: width 0.3s ease; }
.dossier-progress-bar.complete { background: var(--status-validated-text); }

/* NOTES STRUCTURÉES */
.notes-section { display: flex; flex-direction: column; gap: 2px; }
.notes-block { background: var(--bg-elevated); border: 1px solid var(--border-muted); border-radius: var(--radius-md); overflow: hidden; margin-bottom: 6px; }
.notes-block-header { display: flex; align-items: center; gap: 8px; padding: 8px 12px; cursor: pointer; user-select: none; }
.notes-block-header:hover { filter: brightness(1.08); }
.notes-block-title { font-size: 12px; font-weight: 600; color: var(--text-secondary); flex: 1; }
.notes-block-check { display: flex; align-items: center; gap: 5px; font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: var(--radius-full); cursor: pointer; transition: all var(--transition); border: 1px solid var(--border); color: var(--text-muted); background: none; }
.notes-block-check:hover { border-color: var(--status-validated-text); color: var(--status-validated-text); }
.notes-block-check.checked { background: rgba(63,185,80,0.15); color: var(--status-validated-text); border-color: var(--status-validated-border); }
.notes-block-body { padding: 0 12px 10px; }
.notes-block-body.collapsed { display: none; }
.notes-textarea { width: 100%; min-height: 70px; resize: none; overflow-y: hidden; background: var(--bg-input); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 8px; color: var(--text-primary); font-family: var(--font); font-size: 13px; line-height: 1.5; }
.notes-textarea:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(88,166,255,0.15); outline: none; }
.notes-block-chevron { color: var(--text-muted); transition: transform var(--transition); flex-shrink: 0; }
.notes-block-chevron.open { transform: rotate(180deg); }
.notes-global-hint { font-size: 11px; color: var(--text-muted); text-align: right; margin-top: 2px; transition: color 0.3s; }
.notes-global-hint.saved { color: var(--status-validated-text); }

/* CYCLE DE VIE — partagé sidebar ↔ ticket */
.lc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.lc-item { display: flex; flex-direction: column; gap: 3px; }
.lc-label { font-size: 11px; color: var(--text-muted); }
.lc-val { font-size: 13px; color: var(--text-primary); font-weight: 500; }
.lc-val.muted { color: var(--text-muted); font-weight: 400; }
.lc-date-input { font-size: 12px; font-weight: 500; color: var(--text-primary); background: var(--bg-input); border: 1px solid var(--border-muted); border-radius: var(--radius-sm); padding: 3px 6px; width: 126px; cursor: pointer; }
.lc-date-input:focus { border-color: var(--accent); outline: none; box-shadow: 0 0 0 2px rgba(88,166,255,0.15); }
.lc-date-input.expiry-warn   { color: #f0a830; border-color: rgba(240,168,48,0.5); }
.lc-date-input.expiry-danger { color: #f59e42; border-color: rgba(245,158,66,0.5); }
.lc-date-input.expiry-past   { color: #f85149; border-color: rgba(248,81,73,0.5); }
.lc-check-row { grid-column: 1 / -1; display: flex; align-items: center; gap: 10px; padding-top: 8px; border-top: 1px solid var(--border-muted); margin-top: 2px; }
.lc-check-info { flex: 1; display: flex; flex-direction: column; gap: 2px; }
.lc-check-btn { font-size: 12px; padding: 5px 10px; background: var(--bg-hover); border: 1px solid var(--border); border-radius: var(--radius-md); color: var(--text-secondary); cursor: pointer; transition: all var(--transition); white-space: nowrap; }
.lc-check-btn:hover { background: var(--accent); color: white; border-color: var(--accent); }
/* Dernière action journal (dans lc-grid — partagé sidebar ↔ ticket) */
.tp-lastaction-row { grid-column: 1 / -1; padding-top: 8px; border-top: 1px solid var(--border-muted); margin-top: 4px; }
.tp-lastaction-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
.tp-lastaction-date { font-family: 'JetBrains Mono', monospace; }
.tp-lastaction-body { display: flex; flex-direction: column; gap: 3px; }
.tp-lastaction-meta { display: flex; align-items: center; gap: 10px; font-size: 12px; font-weight: 600; }
.tp-lastaction-text { font-size: 12px; color: var(--text-secondary); line-height: 1.4; word-break: break-word; }

/* INDICATEURS — liste compacte (partagée sidebar ↔ ticket) */
.risk-ind-list { display: flex; flex-direction: column; }
.risk-ind-row { display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 5px 0; border-bottom: 1px solid var(--border-muted); }
.risk-ind-row:last-child { border-bottom: none; }
.risk-ind-label { font-size: 11px; color: var(--text-muted); white-space: nowrap; }
.risk-ind-yes  { font-size: 11px; font-weight: 600; color: #3fb950; white-space: nowrap; }
.risk-ind-no   { font-size: 11px; font-weight: 600; color: #f85149; white-space: nowrap; }
.risk-ind-warn { font-size: 11px; font-weight: 600; color: #f59e42; white-space: nowrap; }
.risk-ind-na   { font-size: 11px; color: var(--text-muted); white-space: nowrap; }

/* QUICK ACTIONS */
.quick-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.btn-action { padding: 8px 12px; border-radius: var(--radius-md); border: 1px solid var(--border); color: var(--text-secondary); font-size: 12px; font-weight: 500; text-align: left; display: flex; align-items: center; gap: 6px; transition: all var(--transition); }
.btn-action:hover { background: var(--bg-elevated); color: var(--text-primary); border-color: var(--accent); }
.btn-action.full-width { grid-column: 1 / -1; }
.btn-action.danger:hover { color: var(--status-rejected-text); border-color: var(--status-rejected-text); }
