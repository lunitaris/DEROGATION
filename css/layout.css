/* ================================================================
   LAYOUT â€” Topbar, structure principale, today panel, stats,
            filter bar, sidebar (structure), shortcuts bar
================================================================ */

/* TOPBAR */
#topbar { position: fixed; top: 0; left: 0; right: 0; height: var(--topbar-h); background: var(--bg-surface); border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 16px; padding: 0 20px; z-index: 100; }
.topbar-brand { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 16px; white-space: nowrap; color: var(--text-primary); }
.topbar-brand svg { color: var(--accent); }
#search-input { max-width: 320px; padding: 7px 12px 7px 36px; border-radius: var(--radius-full); }
.search-wrap { position: relative; flex: 1; max-width: 320px; }
.search-wrap svg { position: absolute; left: 11px; top: 50%; transform: translateY(-50%); color: var(--text-muted); pointer-events: none; }
.topbar-actions { display: flex; align-items: center; gap: 8px; margin-left: auto; }
.btn-primary { background: var(--accent); color: #fff; font-weight: 600; padding: 7px 16px; border-radius: var(--radius-md); display: flex; align-items: center; gap: 6px; }
.btn-primary:hover { background: var(--accent-hover); }
.btn-ghost { color: var(--text-secondary); padding: 7px 12px; border-radius: var(--radius-md); border: 1px solid var(--border); }
.btn-ghost:hover { background: var(--bg-elevated); color: var(--text-primary); }
.btn-icon { width: 34px; height: 34px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; color: var(--text-secondary); border: 1px solid var(--border); }
.btn-icon:hover { background: var(--bg-elevated); color: var(--text-primary); }

/* LAYOUT */
#app-body { padding-top: var(--topbar-h); transition: margin-right var(--transition); }
#app-body.sidebar-open { margin-right: var(--sidebar-w); }
#main-content { padding: 20px; max-width: 1400px; margin: 0 auto; }

/* TODAY PANEL */
#today-panel { background: var(--bg-surface); border: 1px solid var(--border); border-radius: var(--radius-lg); margin-bottom: 16px; overflow: hidden; }
.today-header { display: flex; align-items: center; gap: 10px; padding: 12px 16px; cursor: pointer; user-select: none; }
.today-header:hover { background: var(--bg-hover); }
.today-title { font-weight: 600; font-size: 13px; color: var(--text-primary); display: flex; align-items: center; gap: 8px; }
.today-count { background: var(--urgency-p0); color: #fff; font-size: 11px; font-weight: 700; padding: 1px 7px; border-radius: var(--radius-full); min-width: 20px; text-align: center; }
.today-count.zero { background: var(--status-validated-bg); color: var(--status-validated-text); }
.chevron { margin-left: auto; color: var(--text-muted); transition: transform var(--transition); }
.chevron.open { transform: rotate(180deg); }
.today-body { border-top: 1px solid var(--border); padding: 12px 16px; display: flex; flex-wrap: wrap; gap: 10px; }
.today-body.hidden { display: none; }
.today-alert { display: flex; align-items: center; gap: 12px; background: var(--bg-elevated); border-radius: var(--radius-md); padding: 10px 14px; border-left: 3px solid var(--urgency-p0); flex: 1; min-width: 280px; max-width: 480px; cursor: pointer; transition: background var(--transition); }
.today-alert:hover { background: var(--bg-hover); }
.today-alert.expiring { border-left-color: var(--urgency-p1); }
.today-alert.followup { border-left-color: var(--accent); }
.today-alert.ok { border-left-color: var(--status-validated-text); }
.today-alert-info { flex: 1; min-width: 0; }
.today-alert-ticket { font-family: var(--font-mono); font-size: 11px; color: var(--text-muted); }
.today-alert-title { font-size: 13px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.today-alert-reason { font-size: 12px; color: var(--text-secondary); margin-top: 2px; }
.today-empty { color: var(--text-muted); font-size: 13px; padding: 4px 0; }

/* STATS */
#stats-bar { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
.stat-pill { display: flex; align-items: center; gap: 7px; padding: 6px 14px; border-radius: var(--radius-full); font-size: 13px; font-weight: 500; cursor: pointer; border: 1px solid var(--border); background: var(--bg-surface); transition: all var(--transition); white-space: nowrap; }
.stat-pill:hover { border-color: var(--accent); color: var(--accent); }
.stat-pill-active { background: rgba(88,166,255,0.12); border-color: var(--accent); color: var(--accent); }
.stat-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.stat-dot-expired { background: var(--status-expired-text) !important; opacity: 1; border: 1px solid rgba(139,148,158,0.5); }
.stat-num { font-weight: 700; }
.stat-num-warn   { color: var(--urgency-p1); }
.stat-num-danger { color: var(--urgency-p0); }

/* FILTER BAR */
#filter-bar { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; padding: 12px 16px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: var(--radius-lg); transition: border-color var(--transition); }
#filter-bar.has-filters { border-color: var(--accent); box-shadow: 0 0 0 1px rgba(88,166,255,0.15); }
#filter-bar select { width: auto; font-size: 13px; padding: 6px 10px; border-radius: var(--radius-md); cursor: pointer; }
#filter-bar.has-filters select:not([value=""]) { border-color: var(--accent); color: var(--accent); }
.filter-label { font-size: 12px; color: var(--text-muted); font-weight: 500; }
.filter-sep { width: 1px; height: 20px; background: var(--border); margin: 0 4px; }
.view-toggle { display: flex; border: 1px solid var(--border); border-radius: var(--radius-md); overflow: hidden; }
.view-toggle button { padding: 6px 10px; color: var(--text-secondary); font-size: 13px; }
.view-toggle button.active { background: var(--accent); color: #fff; }
.view-toggle button:hover:not(.active) { background: var(--bg-elevated); }
.filter-clear { font-size: 12px; color: var(--text-muted); padding: 5px 10px; border-radius: var(--radius-md); border: 1px solid var(--border); margin-left: auto; }
.filter-clear:hover { color: var(--urgency-p0); border-color: var(--urgency-p0); background: rgba(248,81,73,0.07); }

/* SIDEBAR */
#detail-sidebar { position: fixed; top: var(--topbar-h); right: 0; bottom: 0; width: var(--sidebar-w); background: var(--bg-surface); border-left: 1px solid var(--border); box-shadow: var(--shadow-sidebar); display: flex; flex-direction: column; z-index: 90; transform: translateX(100%); transition: transform var(--transition); }
#detail-sidebar.open { transform: translateX(0); }
.sidebar-topbar { display: flex; align-items: center; gap: 8px; padding: 12px 16px; border-bottom: 1px solid var(--border); flex-shrink: 0; }
.sidebar-nav { display: flex; gap: 4px; margin-right: auto; }
.sidebar-nav button { padding: 4px 8px; border-radius: var(--radius-sm); color: var(--text-secondary); font-size: 13px; }
.sidebar-nav button:hover { background: var(--bg-elevated); }
.sidebar-nav button:disabled { opacity: 0.3; cursor: not-allowed; }
.btn-close { width: 28px; height: 28px; border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 18px; line-height: 1; }
.btn-close:hover { background: var(--bg-elevated); color: var(--text-primary); }
#sidebar-body { flex: 1; overflow-y: auto; padding: 20px 20px 32px; display: flex; flex-direction: column; gap: 20px; }
#sidebar-body::-webkit-scrollbar { width: 6px; }
#sidebar-body::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
.sidebar-hero { display: flex; flex-direction: column; gap: 8px; }
.sidebar-hero-top { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }
.sidebar-title { font-size: 18px; font-weight: 700; color: var(--text-primary); line-height: 1.3; }
.sidebar-ticket { font-family: var(--font-mono); font-size: 12px; color: var(--text-muted); }
.section-label { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-muted); margin-bottom: 8px; }
.sidebar-section { display: flex; flex-direction: column; }
.sidebar-divider { height: 1px; background: var(--border-muted); }

/* SHORTCUTS BAR */
.kbd-hint { display: inline-flex; align-items: center; gap: 3px; font-family: var(--font-mono); font-size: 10px; background: var(--bg-elevated); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 1px 5px; color: var(--text-muted); }
.shortcuts-bar { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; padding: 7px 20px; border-bottom: 1px solid var(--border-muted); background: var(--bg-elevated); font-size: 11px; color: var(--text-muted); position: fixed; top: var(--topbar-h); left: 0; right: 0; z-index: 95; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
.shortcuts-bar.hidden { display: none; }
body.shortcuts-open #app-body { padding-top: calc(var(--topbar-h) + 33px); }
